USE Max76PRD
GO

-- Returns spare parts for requested asset(s)
SELECT DISTINCT s.assetnum AS Asset
	,a.status AS AssetStatus
	,s.itemnum AS Item
	,it.description AS description
	,i.status AS INVStatus
	,i.glaccount AS GLAccount
	,c.accountname AS AccountOwner
	,i.binnum AS Bin
	,i.manufacturer AS Manufacturer
	,i.modelnum AS 'Model Number'
	,i.orderunit AS 'Order Unit'
	,b.curbal AS CurrentBalance
	,i.issueytd AS 'YTD Usage'
	,i.issue1yrago AS 'Issued Last Year'
	,i.issue2yrago AS 'Issued 2 Yr ago'
	,i.issue3yrago AS 'Issued 3 Yr ago'
	,v.lastcost AS 'Last Price'
FROM dbo.sparepart AS s
	INNER JOIN dbo.inventory AS i
ON s.itemnum = i.itemnum AND s.siteid = i.siteid
	INNER JOIN dbo.item AS it 
ON i.itemnum = it.itemnum AND i.itemsetid = it.itemsetid
	INNER JOIN dbo.dasset AS a
ON s.assetnum = a.assetnum AND s.siteid = a.siteid
	INNER JOIN dbo.chartofaccounts AS c
ON i.glaccount = c.glaccount
	INNER JOIN dbo.invbalances AS b
ON i.itemsetid = b.itemsetid AND i.siteid = b.siteid AND i.location = b.location AND i.itemnum = b.itemnum
	INNER JOIN dbo.invvendor AS v
ON i.itemnum = v.itemnum AND i.siteid = v.siteid
WHERE s.siteid = 'FWN' AND it.itemsetid = 'IUS' AND i.location = 'FWNCS' 
	AND  s.assetnum in ('17296','15474','15475','17298','17299','17367','17376','17377','17378','17379','17380','17381','17382','17383','17384','17385','17386','17387','17388','17389','17390','17409','17410','17412','17414','17421','17422','17423','17433','1794','1795','1796','1797','1798','1799','1800','1801','1802','2309-003','302-AIRFLTR-L22','6360','7306','7311','13734','10331','10340','10490','10531','10594','10612','10667','10687','10735','10809','10855','10899','10900','10901','10902','10903','10904','10905','11044','12081','14091','15101','15233','15272','15273','15284','17425','2302-001','2302-002','2302-003','RM0856','14203','15252','15253','15243','15158','17275','18282','1525','10455','10685','10853','11607','11665','1209','1259','1260','1261','1262','1297','1334','1337','1365','1447','1524','15268','15285','15470','16802','16803','16924','1893','2260','2312-01','2368','2555','2724','2842','2897','2916','2920','4026','4996','5633','7874','8134','8135','8136','8439','8620','906','RM0816','RM0828','RM0838','10488','11306','1206','1210','1214','1244','1298','1347','1348','13986','15075','2843','2914','5818','6496','8530','16935','9616','15364','10060','10993','15314','15315','15316','15317','15323','15324','15325','15326','15327','15328','15337','15340','15351','15353','15354','15355','15358','15359','15360','15361','15363','15367','15368','15369','15370','15371','15372','15373','15376','15377','15378','15379','15380','15385','15386','15387','15388','15389','15390','15391','15392','15393','15394','15395','15396','15397','15398','15411','15423','15424','15425','15426','15427','15428','15429','15430','15431','15432','15433','15434','15435','15436','15438','15439','15440','15441','15442','15443','15444','15445','15446','15447','15448','15453','15454','15455','15456','15457','15458','15459','16696','16804','17274','17439','17440','2504-05','17452','16873','17452','10040','10027','10028','10029','10036','10037','10038','10039','10064','10065','10069','10092','10109','10110','10167','10170','10171','10172','10316','10317','10318','10319','10320','10321','10322','10323','10324','10325','10326','10327','10328','10329','10333','10334','10335','10336','10337','10338','10341','10345','10346','10360','10408','10409','10411','10412','10413','10414','10415','10416','10417','10418','10419','10420','10421','10422','10423','10424','10425','10426','10427','10428','10429','10430','10431','10432','10525','10526','10527','10600','10729','10730','10731','10732','10733','10824','10953','11118','11119','11120','11121','11122','11123','11124','11125','11126','11170','11193','11281','11433','11533','11534','11737','11833','11834','11855','11859','11864','12007','12063','12087','12090','12091','12124','12352','12387','12674','12677','12813','12910','15039','15065','15067','15070','15071','15077','15091','15131','15133','15148','15149','15150','15283','16620','17078','1792','7956','9933','10705','10030','10450','10706','10778','10822','10916','10917','10918','10992','11042','11043','11117','11163','11164','11169','11207','11221','11222','11234','11239','11240','11241','11250','11251','11252','11253','11254','11255','11256','11257','11258','11259','11261','11262','11263','11264','11265','11266','11267','11268','11269','11270','11271','11272','11273','11274','11275','11276','11277','11278','11279','11282','11283','11284','11285','11286','11287','11288','11289','11290','11291','11292','11293','11294','11295','11296','11297','11298','11299','11302','11303','11304','113062','11327','11337','11355','11374','11375','11376','11377','11381','11387','11388','11389','11390','11391','11392','11413','11414','11415','11417','11418','11419','11420','11421','11427','11458','11459','11463','11464','11467','11529','11530','11531','11532','11559','11560','11565','11566','11569','11570','11571','11572','11573','11575','11578','11579','11584','11585','11588','11589','11592','11620','11621','11647','11648','11649','11650','11651','11652','11653','11654','11655','11656','11657','11658','11659','11718','11909','11910','11911','11912','11913','11914','11934','11962','12068','12069','12096','12129','12243','12244','12353','12456','12713','12722','12723','12768','12800','12801','12802','12804','12814','15092','15280','15291','2194','2314','2898','2899','4023','5000','5266','5267','5484','5685','5883','5885','5888','6084','648','7978','8043','8044','8110','4720','4721','10994','9373','17281','17281','10611','10663','10664','10665','10666','11816','17442','10490','10550','10226','10407','104083','10919','10920','10921','10935','12365','12460','15261','17261','2231','3324','3360','3361','3364','3384','4101','4759','504','5071','5174','5961','6036','6513','7578','7784','7812','8686','8975','9003','9004','9005','9776','9777','9778','10655','10655','17395','17396','17397','17398','17399','17403','17404','17405','17406','17407','17457','966') 
	AND i.status = 'ACTIVE' AND isdefault = 1
	--AND it.description is NOT null AND i.status = 'OBSOLETE'
ORDER BY Asset,Item;